# Nacos 临时模式和持久化模式的区别

## 介绍：
- 在Nacos Client进行实例注册时，通过Instance对象来携带实例的基本信息的。在Instance中有一个ephemeral字段，用来表示该实例是临时实例，还是持久化实例。

- nacos默认都是true使用临时模式的

- 当然，也是可以通过application的配置来改变这里默认值的，spring.cloud.nacos.discovery.ephemeral=false。

## 临时实例与持久化实例的区别

临时实例与持久化实例的区别主要体现在服务器对该实例的处理上。

- 临时实例向Nacos注册，Nacos不会对其进行持久化存储，只能通过心跳方式保活。默认模式是：客户端心跳上报Nacos实例健康状态，默认间隔5秒，Nacos在15秒内未收到该实例的心跳，则会设置为不健康状态，超过30秒则将实例删除。

- 持久化实例向Nacos注册，Nacos会对其进行持久化处理。当该实例不存在时，Nacos只会将其健康状态设置为不健康，但并不会对将其从服务端删除。

另外，可以使用实例的ephemeral来判断健康检查模式，ephemeral为true对应的是client模式（客户端心跳），为false对应的是server模式（服务端检查）。

## 为什么要设计两种模式？
那么Nacos为什么设计两种模式，它们是为了应对什么样的场景而存在呢？

- 对于临时实例，健康检查失败，则直接可以从列表中删除。这种特性就比较适合那些需要应对流量突增的场景，服务可以进行弹性扩容。当流量过去之后，服务停掉即可自动注销了。

- 对于持久化实例，健康检查失败，会被标记成不健康状态。它的好处是运维可以实时看到实例的健康状态，便于后续的警告、扩容等一些列措施
