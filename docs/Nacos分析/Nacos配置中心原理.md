# Nacos配置中心原理

## 客户端侧
- 当Nacos客户端启动时，会主动到Nacos服务端拉取配置信息并写入到本地缓存。以后需要配置时，先从本地缓存中查找，没有的话，再到服务端查找。
- 为了让客户端和服务端配置保持同步，客户端会类似一直开启一个超时时间为30s的长轮询连接，当服务端在期间有数据返回，该连接会立刻响应，否则请求一直挂起。
- 长轮询接口返回有数据变更时，客户端会再到服务端获取完整的配置信息。

## 服务端侧
- 通过servlet3实现长轮询接口，将请求数据放入到一个队列中，当监听到数据变更，立即返回数据，否则请求线程会一直挂起。
- 提供一个可以获取配置信息的普通接口。